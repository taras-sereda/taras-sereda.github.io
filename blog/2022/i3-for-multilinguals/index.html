<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>i3wm for multilinguals | Taras Sereda</title> <meta name="author" content="Taras Sereda"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ‡ºðŸ‡¦</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://taras-sereda.github.io/blog/2022/i3-for-multilinguals/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QYRRM4TV9Q"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QYRRM4TV9Q");</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://taras-sereda.github.io/"><span class="font-weight-bold">Taras</span> Sereda</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item"> <a class="nav-link" href="/assets/pdf/Resume-Taras-Sereda.pdf" target="_blank">resume </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">i3wm for multilinguals</h1> <p class="post-meta">July 16, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a> Â  Â· Â  <a href="/blog/tag/linux"> <i class="fas fa-hashtag fa-sm"></i> linux</a> Â  <a href="/blog/tag/productivity"> <i class="fas fa-hashtag fa-sm"></i> productivity</a> Â  <a href="/blog/tag/i3wm"> <i class="fas fa-hashtag fa-sm"></i> i3wm</a> Â  </p> </header> <article class="post-content"> <p>One day Iâ€™ve heard about <a href="https://i3wm.org/" target="_blank" rel="noopener noreferrer">i3 tiling window manager</a>. I thought, it looks like <code class="language-plaintext highlighter-rouge">tmux</code> applied to GUI applications. (it turned out to be even more powerful!) So I decided to install Linux with i3 window manager on my mac book pro, and use it as an alternative to macOS, which I like a lot.</p> <p><em>Disclaimer:</em> using i3 is an adventure. You need to configure many things. The learning curve is steep, though along the way you are building an understanding that you can do whatever you can imagine with Linux and i3 as a window manager.</p> <p>In this post I want to share my experience on how to add second input language. In my case I was interested in adding Ukrainian.</p> <ol> <li> <p><strong>Adding a new language.</strong></p> <p>i3 customization can be done via editing <code class="language-plaintext highlighter-rouge">~/.i3/config</code> . My native language is Ukrainian, so to add it as one more language for input the following line should be added to i3 config.</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>exec --no-startup-id "setxkbmap -model pc105 -layout us,ua -option grp:alt_shift_toggle"
</code></pre></div> </div> <p>After rereading config, <code class="language-plaintext highlighter-rouge">alt+shift</code> will toggle between US and UA layouts. Basically thatâ€™s it! though there is more to say on this topicâ€¦</p> </li> <li> <p><strong>Handling unexpected issue.</strong></p> <p>Now when you have more than one language to choose from, another problem sooner or later will arise. :) By default, your computer will be locked in 10 min, if itâ€™s in an idle state. This can be viewed and configured in the same <code class="language-plaintext highlighter-rouge">~/.i3/config</code>.</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>exec --no-startup-id xautolock -time 10 -locker blurlock
</code></pre></div> </div> <p>When your screen is locked, unfortunately, there is no way to change the keyboard layout. It was a disappointment for me, luckily it can be fixed. As stated above <code class="language-plaintext highlighter-rouge">xautolock</code> will use <code class="language-plaintext highlighter-rouge">blurlock</code> as a locker.</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="o">[</span>taras@archibald ~]<span class="nv">$ </span><span class="nb">cat</span> <span class="sb">`</span>which blurlock<span class="sb">`</span>
<span class="c">#!/bin/bash</span>
<span class="nb">set</span> <span class="nt">-eu</span>
   
<span class="nv">RESOLUTION</span><span class="o">=</span><span class="si">$(</span>xrandr <span class="nt">-q</span>|sed <span class="nt">-n</span> <span class="s1">'s/.*current[ ]\([0-9]*\) x \([0-9]*\),.*/\1x\2/p'</span><span class="si">)</span>
   
<span class="c"># lock the screen</span>
import <span class="nt">-silent</span> <span class="nt">-window</span> root jpeg:- | convert - <span class="nt">-scale</span> 20% <span class="nt">-blur</span> 0x2.5 <span class="nt">-resize</span> 500% RGB:- | <span class="se">\</span>
    i3lock <span class="nt">--raw</span> <span class="nv">$RESOLUTION</span>:rgb <span class="nt">-i</span> /dev/stdin <span class="nt">-e</span> <span class="nv">$@</span>
   
<span class="c"># sleep 1 adds a small delay to prevent possible race conditions with suspend</span>
<span class="nb">sleep </span>1
   
<span class="nb">exit </span>0
</code></pre></div> </div> <p>Since <code class="language-plaintext highlighter-rouge">blurlock</code> is essentially a bash script nothing prevents us from modifying it a little bit. I found a handy package <code class="language-plaintext highlighter-rouge">xkb-swith</code> that allows to set and query layouts. So before locking the screen, we should check current layout, and if itâ€™s not US we forcefully set it to US. This will guarantee that weâ€™ll be on the correct layout on a locked screen. Thatâ€™s it!</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="c"># set US layout if it's not US</span>
<span class="nv">current_layout</span><span class="o">=</span><span class="si">$(</span>xkb-switch<span class="si">)</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nv">$current_layout</span> <span class="o">!=</span> <span class="s1">'us'</span> <span class="o">]]</span>
<span class="k">then
    </span>xkb-switch <span class="nt">-s</span> us
<span class="k">fi</span>
</code></pre></div> </div> </li> <li> <p><strong>Adding language indicator to i3bar.</strong></p> <p>By default, <code class="language-plaintext highlighter-rouge">i3bar</code> displays useful data about your system, like CPU load, amount of free space, battery charge level, etc. This data is supplied by <code class="language-plaintext highlighter-rouge">i3status</code> . But it doesnâ€™t show a language indicator. So to added it to the <code class="language-plaintext highlighter-rouge">i3bar</code> I used same <code class="language-plaintext highlighter-rouge">xkb-swith</code> and wrote a custom wrapper over <code class="language-plaintext highlighter-rouge">i3status</code> as suggested in its man page.</p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="o">[</span>taras@archibald ~]<span class="nv">$ </span><span class="nb">cat</span> ~/scripts/my_i3status.sh 
<span class="c">#!/bin/sh</span>
<span class="c"># shell script to prepend i3status with more stuff</span>
   
i3status | <span class="k">while</span> :
<span class="k">do
    </span><span class="nb">read </span>line
    <span class="nv">current_layout</span><span class="o">=</span><span class="si">$(</span>xkb-switch<span class="si">)</span>
    <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$current_layout</span><span class="s2"> | </span><span class="nv">$line</span><span class="s2">"</span> <span class="o">||</span> <span class="nb">exit </span>1
<span class="k">done</span>
</code></pre></div> </div> <p>Lastly itâ€™s necessary to modify <code class="language-plaintext highlighter-rouge">~/.i3/config</code> to pipe output of <code class="language-plaintext highlighter-rouge">my_i3status.sh</code> to the <code class="language-plaintext highlighter-rouge">i3bar</code></p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code># Start i3bar to display a workspace bar (plus the system information i3status if available)
bar {
	i3bar_command i3bar
	status_command ~/scripts/my_i3status.sh
	position bottom
	...
</code></pre></div> </div> <p>After re reading config you should have language indicator displayed on your bar!</p> <p><img src="/assets/img/1657470528.png" alt="i3statusbar"></p> </li> </ol> <p>Thatâ€™s all! Now switching languages doesnâ€™t feel awkward. :)</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2024 Taras Sereda. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>